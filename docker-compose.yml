version: '3.8'

services:

    api-service:
        build: ./app/
        container_name: flask
        volumes:
            - './app/:/app/'
        ports:
            - '5000:5000'
        environment:
            PORT: 5000
            FLASK_ENV: development
            MONGODB_DATABASE: cache
            MONGODB_HOSTNAME: mongodb
            FLASK_DEBUG: 1
        depends_on:
            - db-service
        networks:
            - backend

    db-service:
        image: mongo
        container_name: mongodb
        volumes:
            - 'mongodbdata:/data/db'
        environment:
            MONGO_INITDB_DATABASE: cache
            MONGODB_DATA_DIR: /data/db
            MONDODB_LOG_DIR: /dev/null
        networks:
            - backend
        ports:
            - '27017:27017'

networks:
    backend:
        driver: bridge
volumes:
    mongodbdata:
        driver: local
